# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/core.ipynb.

# %% ../nbs/core.ipynb 2
from __future__ import annotations

import aiohttp

# %% auto 0
__all__ = ['request']

# %% ../nbs/core.ipynb 5
async def request(
    method:str, # HTTP method: GET, POST, DELETE, PUT
    url:str, # Request URL
    headers:dict|None=None, # HTTP headers
    params:dict|None=None,
    data:dict|str|None=None,
    json:dict|None=None,
    proxy:str|None=None,
    auth:aiohttp.BasicAuth|None=None,
    text:bool=False, # Return string? If not, return dict
) -> str|dict: # HTML string or JSON dict
    "Asynchronously send a HTTP request with a new session and return the response."
    async with aiohttp.ClientSession(
        headers=headers,
        auth=auth,
    ) as session:
        methods = {
            'GET': session.get,
            'POST': session.post,
            'DELETE': session.delete,
            'PUT': session.put,
        }
        request = methods.get(
            method,
            session.get,
        )
        async with request(
            url,
            params=params,
            data=data,
            json=json,
            proxy=proxy,
        ) as response:
            if text:
                return await response.text()
            else:
                return await response.json()
